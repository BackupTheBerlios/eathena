//================================================
//prtg_cas01 Abrai Kafra test script by Kalen
//================================================
//とりあえず、TEST作成('A`)
//prtg_cas01.txtのアブライはコメントアウトですよ〜
prtg_cas01.gat,112,181,0	script	アブライ	55,{
//check Guild
//debag
//goto LStart3;
// ------- アジト未占領 ----------------------------------
LStart:
	mes "[執事アブライ]";
	mes "私は、主人を待っています…、";
	mes "勇敢なプレイヤー！あなたを待ってますよ！！";
	close;
// -------- マスターじゃない ------------------------------
LStart2:
//check Guildmaster?(Master -> LStart3, Other -> -)
	mes "[執事アルプレド]";
	mes "あなた方がいくら脅そうとも、";
	mes "私は私のマスターである";
	mes "^ff0000 $[$@GUILDMASTER] ^000000様にのみ";
	mes "お仕えする身である。";
	mes "ガーディアンたちはどこか！";
	mes "早くこの無礼な者等を追放しなさい！";
	close;
// -------- 以下マスター時 ---------------------------------
LStart3:
	mes "[執事アブライ]";
	mes "ようこそ！";
	mes "我がマスター ^ff0000 GUILDMASTER ^000000 様!";
	mes "用事があるならなんなりと";
	mes "お申し付けくださいませ！";
	next;
	menu "ギルドのプロパティ",L1,"商業への投資",L2,"ディフェンスへの投資",L3,"ガーディアン設置",L4,"カプラとの契約・解雇",L5,"マスタールームに行く",L6,"アジトを放棄する",L7;
//-----------------------------------------------------------
//================================================
//Phase 1:ギルドのプロパティ(未調整)
//================================================
L1:
	mes "[執事アブライ]";
	mes "ギルド基礎情報:";
	mes " ";
	mes "^0000ff現在の通商投資は" + $edegree + "です。";
	mes "- 最後の期間に" + $etrigger + "回投資しました。";
	mes "現在の防御投資は" + $ddegree + "です。";
	mes "- 最後の期間に" + $dtrigger + "回投資しました。^000000";
	mes " ";
	mes "以上です。";
	close;
//================================================
//Phase 2:商業への投資(未調整)
//================================================
L2:
	mes "[執事アブライ]";
	mes "あなたが通商投資を増やせば、ギルドの生産的な力はより多くの品物を生産するために増加します。";
	mes " ";
	mes "一日に一回、一期間に二回まで投資できます。";
	next;
//if($etrigger<2) goto L2_1;
		mes "[執事アブライ]";
		mes "^ff0000ギルド投資は現在100%です。";
		mes "今は投資する必要がありません。^000000";
	 	close;
L2_1:
	mes "[執事アブライ]";
	mes "^ff0000あなたは、一期間に2回まで投資することが出来ます。^000000";
	mes " ";
	mes "必要な投資量は^ff0000 10,000 ^000000Zenyです";
	mes "投資しますか？";
	next;
	menu "投資する",L2_1_1,"投資しない",-;
		mes "[執事アブライ]";
		mes "了解しました。";
		mes "急ぐ必要は無いですからね〜";
		close;
	L2_1_1:
		if(Zeny < 10000) goto L2_error;
		set Zeny,Zeny-10000;
//投資コマンド(商業費)
//etriggerを+1する
		mes "[執事アブライ]";
		mes "投資に成功しました。";
		close;
L2_error:
	mes "[執事アブライ]";
	mes "マスター！";
	mes "投資に必要なお金がありません。";
	mes "投資を取り消しました。";
	close;
//================================================
//Phase 3:ディフェンスへの投資(現状実装無理か？)
//================================================
L3:
//var defenseOK = AgitGet AGIT_D_FUNDING_OK  
	mes "[執事アブライ]";
	mes "あなたが防御投資し、ガーディアンやエンペリウムのHPを増加させれば、敵が攻めてきたときに大いに助けになるでしょう";
	mes " ";
	mes "一日に一回、一期間に二回まで投資できます。";
//if($dtrigger<2) goto L3_1;
		mes "[執事アブライ]";
		mes "^ff0000ギルド投資は現在100%です。";
		mes "今は投資する必要がありません。^000000";
	 	close;
L3_1:
	mes "[執事アブライ]";
	mes "^ff0000あなたは、一期間に2回まで投資することが出来ます。^000000";
	mes " ";
	mes "必要な投資量は^ff0000 10,000 ^000000Zenyです";
	mes "投資しますか？";
	next;
	menu "投資する",L3_1_1,"投資しない",-;
		mes "[執事アブライ]";
		mes "了解しました。";
		mes "急ぐ必要は無いですからね〜";
		close;
	L3_1_1:
		if(Zeny < 10000) goto L3_error;
		set Zeny,Zeny-10000;
//投資コマンド(防衛費)
//dtriggerを+1する
		mes "[執事アブライ]";
		mes "投資に成功しました。";
		close;
L3_error:
	mes "[執事アブライ]";
	mes "マスター！";
	mes "投資に必要なお金がありません。";
	mes "投資を取り消しました。";
	close;
//================================================
//Phase 4:ガーディアン設置
//================================================
L4:
	mes "[執事アブライ]";
	mes "ガーディアンを設置しますか？";
	mes "ガーディアンは敵からギルドベースを保護するでしょう。";
	mes "ガーディアンを選んでください。";
	next;
	menu "Soldier 1",L4_1,"Soldier 2",L4_2,"Soldier 3",L4_3,"Archer 1",L4_4,"Archer 2",L4_5,"Knight 1",L4_6,"Knight 2",L4_7,"Knight 3",L4_8;
		L4_1: set @GDnum,1;goto L4_9;
		L4_2: set @GDnum,2;goto L4_9;
		L4_3: set @GDnum,3;goto L4_9;
		L4_4: set @GDnum,4;goto L4_9;
		L4_5: set @GDnum,5;goto L4_9;
		L4_6: set @GDnum,6;goto L4_9;
		L4_7: set @GDnum,7;goto L4_9;
		L4_8: set @GDnum,8;goto L4_9;
	L4_9:
		mes "[執事アブライ]";
		mes "本当に設置しますか？";
		mes "ガーディアンの設置には^ff0000 10,000 ^000000Zenyが必要です。";
		next;
		menu "設置する",L4_9_1,"やめる",-;
			mes "[執事アブライ]";
			mes "了解しました。";
			mes "急ぐ必要は無いですからね〜";
			close;
		L4_9_1:
//ギルドスキルの判定→ダメならL4Error
//@GDnumのガーディアン調査→設置済みならL4Error2
		if (Zeny < 10000) goto L4Error3;
		set Zeny,Zeny-10000;
//@GDnumのガーディアンON
		mes "[執事アブライ]";
		mes "ガーディアンが設置されました。";
		mes "ガーディアンは私達の城を敵から守ってくれるでしょう。";
		close;
L4Error:
	mes "[執事アブライ]";
	mes "マスター！";
	mes "ガーディアンを設置するギルドスキルがありません。ガーディアンを設置するスキルを獲得したければ、＾ff0000ガーディアンスキル＾000000を得なければなりません。";
	mes " ";
	mes "ガーディアン設置が取り消されました。";
	close;
L4Error2:
	mes "[執事アブライ]";
	mes "マスター！";
	mes "既にガーディアンが設置されています。";
	mes " ";
	mes "ガーディアン設置が取り消されました。";
	close;
L4Error3:
	mes "[執事アブライ]";
	mes "マスター！";
	mes "投資に必要なお金がありません。";
	mes "投資を取り消しました。";
	close;
//================================================
//Phase 5:カプラとの契約・解雇
//================================================
L5:
//カプラがいるかどうかチェック
//=========================
//(When Karfa off) Employment
//=========================
	mes "[執事アブライ]";
	mes "カプラとの契約を結びますか？";
	mes "契約には^ff0000 10000 ^000000Zeny 必要です";
	next;
	menu "契約する",-,"キャンセル",L_k_E;
//check Kafraskill(OK -> L_k_0,NG -> -)
		mes "[執事アブライ]";
		mes "マスター！どうやらスキルが足りないようです。カプラと契約するには ^ff0000KAFRA SKILL^000000 が必要です。";
		close;
	L_k_0:
		if (Zeny > 10000) goto L_k_1;
		mes "[執事アブライ]";
		mes "マスター！お金が足りませんよ！";
		close;
	L_k_1:
		set Zeny,Zeny-10000;
		enablenpc "カプラ職員";
//set \prt01_k = 1,0;
		mes "[執事アブライ]";
		mes "カプラとの契約が完了しました";
		next;
		cutin "kafra_01",2;
		mes "[カプラ職員]";
		mes "初めまして、カプラディフォルテと申します。";
		mes "最善を尽くしますので宜しくおねがいします！";
		next;
		cutin "kafra_01",255;
		mes "[執事アブライ]";
		mes "ギルドベースでカプラとの契約を維持するために";
		mes "毎月Zenyを払わなければなりません。";
		close;
L_k_e:
		mes "[執事アブライ]";
		mes "イエッサー！";
		mes "でも、そろそろカプラがほしいですね。";
		close;
//=========================
//(When karfa ON) Dismissal
//=========================
	mes "[執事アブライ]";
	mes "カプラ職員との契約を破棄しますか？";
	next;
	menu "解雇する",-,"キャンセル",L_D_1;
		cutin "kafra_01",2;
		mes "[カプラ職員]";
		mes "私が何か間違っていましたか？そうならば、許してはもらえませんか…";
		next;
		menu "解雇する",-,"キャンセル",L_D_2;
				mes "[カプラ職員]";
				mes "ああ、解雇なさるんですね、、、TT";
				next;
				disablenpc "カプラ職員";
//set \prt01_k = 0,0;
				cutin "kafra_01",255;
				mes "[執事アブライ]";
				mes "....";
				mes "カプラとの契約が破棄されました。";
				close;
			L_D_2:
				mes "[カプラ職員]";
				mes "ありがとうございます。全力を尽くして執務につきます！";
				cutin "kafra_01",255;
				close;
		L_D_1:
			mes "[執事アブライ]";
			mes "わかりました。";
			close;
L5_1:
//================================================
//Phase 6:マスタールームに行く
//================================================
L6:
	mes "[執事アブライ]";
	mes "マスタールームへいきますか？";
	mes "マスタールームに入れるのはギルドマスターだけです。つまり、入れるのはあなた一人だけということです。";
	next;
	menu "マスタールームに入る",-,"キャンセル",L6_1;
			mes "[執事アブライ]";
			mes "では、私の後についてきてください。";
			mes "部屋から出るときは、レバーを引いてくださいね";
			next;
			warp "prtg_cas01",15,209;
		L6_1:
			mes "[執事アブライ]";
			mes "品物は常に生産されています。出来る限り毎日取りに行ってください。";
			mes "そのうちに品物をすべて得ることを怠らないでください。";
			close;
//================================================
//Phase 7: アジト放棄
//================================================
L7:
	mes "[執事アブライ]";
	mes "マスター！";
	mes "アジトを放棄するんですか！？";
	mes " ";
	mes "どうか考え直してください、マスター！";
	next;
	menu "アジトを放棄する",L7_1,"キャンセル",L7_2;
		L7_1:
			mes "[執事アブライ]";
			mes "マスター！";
			mes "どうかもう一度考え直してください…T_T!!";
			mes "どうか、、お願い!!!!!!!!";
			next;
			menu "やめる",L7_2,"アジトを放棄する",-;
				mes "[執事アブライ]";
				mes "マスター!!…";
				mes "…い……やだ……ぁ……";
//ギルド崩壊！
				close;
		L7_2:
			mes "[執事アブライ]";
			mes "イエッサー！マスター^^!";
			mes "もう、そんな冗談よしてくださいよ^^.";
			close;
}
