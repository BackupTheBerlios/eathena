//===================================================================
//prtg_cas01         by kalen
//===================================================================
prt_gld.gat,131,60,6	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prt_gld.gat,138,68,6	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prt_gld.gat,138,60,6	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prt_gld.gat,135,60,6	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,58,56,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,64,56,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,76,32,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,84,32,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,94,39,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,94,24,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,73,14,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,73,6,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,55,46,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
prtg_cas01.gat,45,46,4	script	Kriemhild	722,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 != 0) goto LStartg;
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    this guild base isn't taken by";
		mes "    any guild yet.";
		mes " ";
		mes "2. In order to take this guild base,";
		mes "    you must defeat all the guardians";
		mes "    that protecting guild base and";
		mes "    eliminate the emperium to";
		mes "    take over the guild base.";
		close;
LStartg:
		mes "       [ Kingdom of Prontera ]";
		mes " ";
		mes "1. As Law of Prontera";
		mes "    ^ff0000" + GetGuildName(@GIDp1) + "^000000 guild's guild";
		mes "    base.";
		mes " ";
		mes "2. ^ff0000" + GetGuildName(@GIDp1) + "^000000 Guild master is";
		mes "    ^ff0000" + GetGuildMaster(@GIDp1) + "^000000, and if any of you";
		mes "    have a beef, raise your sword to";
		mes "    honor yourself.";
		close;
}
//------------------------------カプラ--------------------------------
prtg_cas01.gat,96,173,0	script	Kafra Service#prt1	117,{
	cutin "kafra_01",2;
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (getcharid(2) == @GIDp1) goto LStartg;
	mes "[Kafra Service]";
	mes "I am here to help only ^ff0000" + GetGuildName(@GIDp1) + "^000000 members, please use different Kafra Service. thank you.";
	goto L_EXIT;
LStartg:
	mes "[Kafra Service]";
	mes "Welcome. ^ff0000" + GetGuildName(@GIDp1) + "^000000 members";
	mes "Kafra Service is always with you guys";
	next;
	menu "Open Storage",L2,"Teleport Service",L3,"Use Cart Service",L4,"Cancel",L7;
L2:
	if(getskilllv(1) < 6) goto Lerror2_1;
	if (Zeny < 40) goto Lerror2_2;
		set Zeny,Zeny-40;
		openstorage;
		goto L_EXIT;
	Lerror2_1:
		mes "[Kafra Service]";
		mes "You must have lvl 6 or higher novice skill.";
		goto L_EXIT;
	Lerror2_2:
		mes "[Kafra Service]";
		mes "Sorry, you don't have enough Zeny to use the storage service.";
		goto L_EXIT;
L3:
	mes "[Kafra Service]";
	mes "Please choose a city.";
	next;
	menu "Prontera -> 200 z",L3_1,"Cancel",L3_2;
		L3_1:
			if (Zeny < 200) goto Lerror3;
			set Zeny,Zeny-200;set KF_PIT,KF_PIT+20;warp "prontera.gat",278,211;end;
		L3_2:
				mes "[Kafra Service]";
				mes "Kafra Service always trying to offer best service for you.";
				mes "Thank you for using our service.";
				goto L_EXIT;
		Lerror3:
				mes "[Kafra Service]";
  				mes "Sorry, you don't have enough Zeny to use the teleport service.";
				goto L_EXIT;
L4:
	if (!((Class == 5) || (Class == 10) || (Class == 18))) goto Lerror4_1;
	mes "[Kafra Service]";
	mes "Cart Rental is  800 Zeny and the [Pushcart] skill is neccessary.";
	mes "Would you like to rental?";
	next;
	menu "Rent Cart",L4_1,"Cancel",-;
		mes "[Kafra Service]";
		mes "Kafra Service always trying to offer best service for you.";
		mes "Thank you for using our service.";
		goto L_EXIT;
	L4_1:
		if (Zeny < 800) goto Lerror4_2;
		set Zeny,Zeny-800;
		setcart;
		goto L_EXIT;
	Lerror4_1:
		mes "[Kafra Service]";
		mes "Sorry, Cart Renting Service is only for Merchant/Blacksmith/Alchemist.";
		goto L_EXIT;
	Lerror4_2:
		mes "[Kafra Service]";
		mes "Sorry, you must have at least 800 zeny.";
		goto L_EXIT;
//Cart already have
//Lerror4_3:
//mes "[Kafra Service]";
//mes "お客様は現在カートを";
//mes "利用されています。";
//goto L_EXIT;
L7:
	mes "[Kafra Service]";
	mes "Kafra Service always trying to offer best service for you.";
	mes "Thank you for using our service.";
L_EXIT:
	cutin "kafra_01",255;
	close;
OnInit:
	if (getcastledata("prtg_cas01.gat",9) == 1) end;
	disablenpc "Kafra Service#prt1";
	end;
}
//-------------------------------執事(TEST SCRIPT有)------------------
//prtg_cas01.gat,112,181,0	script	Abrai	55,{
//	set @GIDp1,getcastledata("prtg_cas01.gat",1);
//	if (getcharid(2) == @GIDp1) goto LStartg;
//	mes "NO MSG";
//	close;
//LStartgm:
//	mes "[ Abrai ]";
//	mes "あなた方がいくら脅そうとも、";
//	mes "私は私のマスターである";
//	mes "^ff0000" + GetGuildMaster(@GIDp1) + "^000000様にのみ";
//	mes "お仕えする身である。";
//	mes "ガーディアンたちはどこか！";
//	mes "早くこの無礼な者等を追放しなさい！";
//	close;
//LStartg:
//	mes "Function not yet coded";
//	close;
//}
//-----------------------------Switch-------------------------------
prtg_cas01.gat,15,209,0	script	Switch	111,{
	mes " ";
	mes "There is little switch over here would you like to pull the switch down?";
	next;
	menu "Yes",-,"No",L2;
	warp "prtg_cas01.gat",112,183;
	end;
L2:
	close;
}
//-----------------------------Switch 2------------------------------
prtg_cas01.gat,94,200,0	script	Switch 2	111,{
	mes "[ Vibration of Man's Voice ]";
	mes " ' Only brave man get to lead the guild base.. '";
	next;
	mes " ";
	mes "There is little switch over here would you like to pull the switch down?";
	next;
	menu "Yes",-,"No",L2;
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (getcharid(2) != @GIDp1) goto L1n;
	warp "gld_dun03.gat",28,251;
	end;
L1n:
	mes "[ Vibration of Man's Voice ]";
	mes " ' LOOOOOOOOSER...... ' ";
L2:
	close;
}
//================================================
//prtg_cas01 Abrai Kafra test script by Kalen (Translated By AppleGirl)
//================================================
//とりあえず、TEST作成('A`)
//prtg_cas01.txtのアブライはコメントアウトですよ〜
prtg_cas01.gat,112,181,0	script	Abrai	55,{
	set @GIDp1,getcastledata("prtg_cas01.gat",1);
	if (@GIDp1 == 0) goto LStart;
	if (getcharid(2) != @GIDp1) goto LStart2;
	if (strcharinfo(0) == getguildmaster(@GIDp1)) goto LStart3;
	
// ------- アジト未占領 ----------------------------------
LStart:
	mes "[ Abrai ]";
	mes "I am waiting for my master.";
	mes "Brave Player! follow your destiny!...";
	close;
// -------- マスターじゃない ------------------------------
LStart2:
	mes "[ Abrai ]";
	mes "I am here to follow ^ff0000" + getguildmaster(@GIDp1) + "^000000 's command! where are you guardians! destroy these bastards!";
	close;
// -------- 以下マスター時 ---------------------------------
LStart3:
	mes "[ Abrai ]";
	mes "Welcome Master ^ff0000" + getguildmaster(@GIDp1) + "^000000 !";
	mes "I'll do anything you tell me to do sir!.";
	next;
	menu "Guild Base Property",L1,"Commerce Investment",L2,"Defence Investment",L3,"Guardian Installation",L4,"Kafra Service Employement / Dismissal",L5,"Enter Master's Room",L6,"Empty Guild Base",L7;
//-----------------------------------------------------------
//================================================
//Phase 1:ギルドのプロパティ(未調整)
//================================================
L1:
	mes "[ Abrai ]";
	mes "Guild Base Commerce Investment Improvement Information.";
	mes " ";
	mes "^0000ffCurrent Commerce Investment is" + GetCastleData("prtg_cas01.gat",2) + ".";
	mes "- You have invested" +  GetCastleData("prtg_cas01.gat",4)  + "times in last time.";
	mes " ";
	mes " Current Defence" +  GetCastleData("prtg_cas01.gat",3)  + ".^000000";
	mes "^0000ff- You have invested" +  GetCastleData("prtg_cas01.gat",5)  + "times in last time.^000000";
	mes " ";
	mes "That is about it.";
	close;
//================================================
//Phase 2:商業への投資(未調整)
//================================================
L2:
	mes "[ Abrai ]";
	mes "If you improve your Commerce Investments, Guild's Productive power increases to produce goods.";
	mes " ";
	mes "You must Invest once a day, but you can also invest two times a day.";
	next;
	set @TriggerE,GetCastleData("prtg_cas01.gat",4);
	set @Economy,GetCastleData("prtg_cas01.gat",2);
	if(@TriggerE < 2) goto L2_1;
		mes "[ Abrai ]";
		mes " ";
		mes "^ff0000Guild's Investment is currently at 100% you don't have to invest anymore.^000000";
	 	close;
L2_1:
	mes "[ Abrai ]";
	mes " ";
	mes "Required invest amount is^ff0000" + 10,000 + "^000000 Zeny. Would you like to invest?";
	next;
	menu "Invest Commerce.",L2_1_1,"Cancel.",-;
		mes "[ Abrai ]";
		mes "I'll follow your order Master!... you don't have to be hurry anywayz.";
		close;
	L2_1_1:
		if(Zeny < 10000) goto L2_error;
		set Zeny,Zeny-10000;
		SetCastleData "prtg_cas01.gat",4,@TriggerE+1;
		SetCastleData "prtg_cas01.gat",2,@Economy+10000;
		mes "[ Abrai ]";
		mes "You invested successfully.";
		close;
L2_error:
	mes "[ Abrai ]";
	mes "Master, you do not have enough money to invest, investment has been cancelled.";
	close;
//================================================
//Phase 3:ディフェンスへの投資(現状実装無理か？)
//================================================
L3:
//var defenseOK = AgitGet AGIT_D_FUNDING_OK  
	mes "[ Abrai ]";
	mes "If you improve investment of defence, HP of guardian/emperium increase, it helps when enemy try to attack you guild.";
	mes " ";
	mes "You must Invest once a day, but you can also invest two times a day.";
	next;
	set @TriggerD,GetCastleData("prtg_cas01.gat",5);
	set @Deffence,GetCastleData("prtg_cas01.gat",3);
	if(@TriggerD < 2) goto L3_1;
		mes "[ Abrai ]";
		mes " ";
		mes "^ff0000Guild's Investment is currently at 100% you don't have to invest anymore.^000000";
	 	close;
L3_1:
	mes "[ Abrai ]";
	mes " ";
	mes "Required invest amount is ^ff0000" + 10,000 + "^000000 Zeny. Would you like to invest?";
	next;
	menu "Invest Defence.",L3_1_1,"Cancel",-;
		mes "[ Abrai ]";
		mes "I'll follow your order Master!... you don't have to be hurry anywayz.";
		close;
	L3_1_1:
		if(Zeny < 10000) goto L3_error;
		set Zeny,Zeny-10000;
		SetCastleData "prtg_cas01.gat",5,@TriggerD+1;
		SetCastleData "prtg_cas01.gat",3,@Deffence+10000;
		mes "[ Abrai ]";
		mes "You invested successfully.";
		close;
L3_error:
	mes "[ Abrai ]";
	mes "Master, you do not have enough money to invest, investment has been cancelled.";
	close;
//================================================
//Phase 4:ガーディアン設置
//================================================
L4:
	If(getguildskilllv(10002) == 0) goto L4Error;
	mes "[ Abrai ]";
	mes "Would you like to install a guardian? Guardian will protect guild base from enemies.";
	mes "Please choose guardian.";
	next;
	menu "Soldier 1",L4_1,"Soldier 2",L4_2,"Soldier 3",L4_3,"Archer 1",L4_4,"Archer 2",L4_5,"Knight 1",L4_6,"Knight 2",L4_7,"Knight 3",L4_8;
		L4_1:
			if (GetCastleData("prtg_cas01.gat",10) == 1) goto L4Error2;
			set @GDnum,10;goto L4_9;
		L4_2:
			if (GetCastleData("prtg_cas01.gat",11) == 1) goto L4Error2;
			set @GDnum,11;goto L4_9;
		L4_3:
			if (GetCastleData("prtg_cas01.gat",12) == 1) goto L4Error2;
			set @GDnum,12;goto L4_9;
		L4_4:
			if (GetCastleData("prtg_cas01.gat",13) == 1) goto L4Error2;
			set @GDnum,13;goto L4_9;
		L4_5:
			if (GetCastleData("prtg_cas01.gat",14) == 1) goto L4Error2;
			set @GDnum,14;goto L4_9;
		L4_6:
			if (GetCastleData("prtg_cas01.gat",15) == 1) goto L4Error2;
			set @GDnum,15;goto L4_9;
		L4_7:
			if (GetCastleData("prtg_cas01.gat",16) == 1) goto L4Error2;
			set @GDnum,16;goto L4_9;
		L4_8:
			if (GetCastleData("prtg_cas01.gat",17) == 1) goto L4Error2;
			set @GDnum,17;goto L4_9;
	L4_9:
		mes "[ Abrai ]";
		mes "Would you really like to install guardian? You need 10,000 zeny to install.";
		next;
		menu "Install",L4_9_1,"Cancel",-;
			mes "[ Abrai ]";
			mes "I'll follow your order sir, but it is worth to have a guardian soon or later.";
			close;
		L4_9_1:
//ギルドスキルの判定→ダメならL4Error
		if (Zeny < 10000) goto L4Error3;
		set Zeny,Zeny-10000;
		setcastledata "prtg_cas01.gat",@GDnum,1;
		mes "[ Abrai ]";
		mes "Guardian has been installed, guardian will protect our guild base against enemies.";
		close;
L4Error:
	mes "[ Abrai ]";
	mes "Master, you do not have any guild skill to install guardian, if you want to gain skill to install guardian, you must get ^ff0000GUARDIAN SKILL^000000. Guardian Installation has been cancelled.";
	close;
L4Error2:
	mes "[ Abrai ]";
	mes "Master...you installed that guardian already.";
	close;
L4Error3:
	mes "[ Abrai ]";
	mes "Master, you do not have enough money to invest, investment has been cancelled.";
	close;
//================================================
//Phase 5:カプラとの契約・解雇
//================================================
L5:
	if (GetCastleData("prtg_cas01.gat",9) == 1) goto Lkafra_dimi;
//=========================
//(When Karfa off) Employment
//=========================
	If(getguildskilllv(10001) == 0) goto L_k_a;
	mes "[ Abrai ]";
	mes "Would you like to employee  new Kafra Service?";
	mes "^ff0000 You need 10,000 Zeny to employee... ";
	next;
	menu "Employ Kafra.",L_k_0,"Cancel",L_k_E;

	L_k_a:
		mes "[ Abrai ]";
		mes "Master, you havn't contract with Kafra Service Company. In order to contract with Kafra Server is to have ^ff0000KAFRA SKILL^000000 employment has been canceld .";
		close;
	L_k_0:
		if (Zeny > 10000) goto L_k_1;
		mes "[ Abrai ]";
		mes "Master, you do not have enough money to employee Kafra, employment has been cancelled.";
		close;
	L_k_1:
		set Zeny,Zeny-10000;
		enablenpc "Kafra Service#prt1";
		setcastledata "prtg_cas01.gat",9,1;
		mes "[ Abrai ]";
		mes "You have been contracted with Kafra Service Company.";
		next;
		cutin "kafra_01",2;
		mes "[ Kafra Service ]";
		mes "Hello, I came here to follow your order sir!^^.";
		mes "I'll do the best I can.";
		next;
		cutin "kafra_01",255;
		mes "[ Abrai ]";
		mes "You must pay zeny every month to keep Kafra in your guild base.";
		mes "I hope you guyz have good time with our sexy Kafra /gg.";
		close;
L_k_e:
		mes "[ Abrai ]";
		mes "Yes Master! But you must get Kafra as soon as possible.";
		close;
//=========================
//(When karfa ON) Dismissal
//=========================
Lkafra_dimi:
	mes "[ Abrai ]";
	mes "Would you like to dismissal current Kafra Service?";
	next;
	menu "Dismissal",-,"Cancel",L_D_1;
		cutin "kafra_01",2;
		mes "[ Kafra Service ]";
		mes "What have I done wrong? if so, would you please forgive me?";
		next;
		menu "Dismissal",-,"Cancel",L_D_2;
				mes "[ Kafra Service ]";
				mes "OMG!! how could you do this to meeeeh!! T_T~"
				next;
				disablenpc "Kafra Service#prt1";
				setcastledata "prtg_cas01.gat",9,0;
				cutin "kafra_01",255;
				mes "[ Abrai ]";
				mes "....";
				mes "Kafra Service has been dismissed";
				close;
			L_D_2:
				mes "[ Kafra Service ]";
				mes "Thank you master, I'll do my best! ^^.";
				cutin "kafra_01",255;
				close;
		L_D_1:
			mes "[ Abrai ]";
			mes "I think you should keep the current Kafra sir, she's trying her best sir.";
			close;
L5_1:
//================================================
//Phase 6:マスタールームに行く
//================================================
L6:
	mes "[ Abrai ]";
	mes "Would you like to get into our treasure room?";
	mes "That place is only for guild master, which means you are the only one who has access to enter.";
	next;
	menu "Enter Master's room.",-,"Cancel",L6_1;
			mes "[ Abrai ]";
			mes "Please follow me through the secret way.";
			mes "You must push downt the secret switch in order to get out.";
			next;
			warp "prtg_cas01",15,209;
		L6_1:
			mes "[ Abrai ]";
			mes "Goods are producing everyday, you must get'em whenever you can.";
			mes "Please don't forget to get all the goods in time.";
			close;
//================================================
//Phase 7: アジト放棄
//================================================
L7:
	mes "[ Abrai ]";
	mes "Master!!";
	mes "Are you goin to give our guild up?!";
	mes "It is not worth to give up on our guild master!!!";
	mes "Please reconsider master!!";
	next;
	menu "Empty Guild Base",L7_1,"Cancel",L7_2;
		L7_1:
			mes "[ Abrai ]";
			mes "Master, please reconsider...T_T!!";
			mes "OMG, please!!!!!!!!";
			next;
			menu "Cancel",L7_2,"Empty Guild Base",-;
				mes "[ Abrai ]";
				mes "Master!!.....";
				mes "......BAS......TA..RD......";
				next;
		setcastledata "prtg_cas01.gat",1,0;
		setcastledata "prtg_cas01.gat",2,0;
		setcastledata "prtg_cas01.gat",3,0;
		setcastledata "prtg_cas01.gat",4,0;
		setcastledata "prtg_cas01.gat",5,0;
		setcastledata "prtg_cas01.gat",6,0;
		setcastledata "prtg_cas01.gat",7,0;
		setcastledata "prtg_cas01.gat",8,0;
		setcastledata "prtg_cas01.gat",9,0;
		setcastledata "prtg_cas01.gat",10,0;
		setcastledata "prtg_cas01.gat",11,0;
		setcastledata "prtg_cas01.gat",12,0;
		setcastledata "prtg_cas01.gat",13,0;
		setcastledata "prtg_cas01.gat",14,0;
		setcastledata "prtg_cas01.gat",15,0;
		setcastledata "prtg_cas01.gat",16,0;
		setcastledata "prtg_cas01.gat",17,0;
		Announce "Stronghold [" + GetCastleName("prtg_cas01.gat") + "], [" + GetGuildName(@GIDp1) + "] has surrendered the castle",0;
		MapRespawnGuildID "prtg_cas01.gat",GetCastleData("prtg_cas01.gat",1),7;
		end;
		L7_2:
			mes "[ Abrai ]";
			mes "I knew it master^^!!";
			mes "Please, don't freak me out like that again^^.";
			close;
}
